(()=>{"use strict";var e=function(e){var t=e.title,n=e.className,r=e.listener,o=document.createElement("button");return o.innerHTML=t,o.classList.add(n),o.addEventListener("click",r),o},t=function(){},n=function(){},r=function(){},o=function(){},i=function(){};function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t,n,r,o,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.number=n,localStorage.getItem("field")&&JSON.parse(localStorage.getItem("field")).length===this.number?this.field=JSON.parse(localStorage.getItem("field")):this.field=this.createField(),this.color="#39bfb4",this.ctx=t,this.width=r,this.height=o,this.cellSize=this.width/this.number,this.clicks=0,this.size=i}var t,n;return t=e,(n=[{key:"check",value:function(e,t){var n=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}return e}(e),r=function(e,t){for(var n=0,r=new Array,o=0;o<t;o++){r[o]=new Array;for(var i=0;i<t;i++)r[o][i]=e[n],n++}return r}(n,t),o=Boolean(function(e,n){var r=function(e){for(var n=0,r=0;r<t*t-1;r++)for(var o=r+1;o<t*t;o++)e[o]&&e[r]&&e[r]>e[o]&&n++;return n}(e);if(1&t)return!(1&r);var o=function(e){for(var n=t-1;n>=0;n--)for(var r=t-1;r>=0;r--)if(0==e[n][r])return t-n}(n);return 1&o?!(1&r):1&r}(n,r));return[o,r]}},{key:"createField",value:function(){for(var e=[],t=0;t<this.number*this.number;t++)e[t]=t;var n,r=!1;do{var o=a(this.check(e,this.number),2);r=o[0],n=o[1]}while(!r);return n}},{key:"ee",value:function(){this.ctx.fillStyle="lightblue",this.ctx.fillRect(0,0,this.width,this.height)}},{key:"getClicks",value:function(){return this.clicks}},{key:"drawCell",value:function(e,t){this.ctx.fillStyle=this.color,this.ctx.fillRect(e+1,t+1,this.cellSize-2,this.cellSize-2)}},{key:"num",value:function(){this.ctx.font="bold ".concat(this.size,"px sans"),this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="#333"}},{key:"draw",value:function(){for(var e=0;e<this.number;e++)for(var t=0;t<this.number;t++)this.field[e][t]>0&&(this.drawCell(t*this.cellSize,e*this.cellSize),this.num(),this.ctx.fillText(this.field[e][t],t*this.cellSize+this.cellSize/2,e*this.cellSize+this.cellSize/2))}},{key:"getNullCell",value:function(){for(var e=0;e<this.number;e++)for(var t=0;t<this.number;t++)if(0===this.field[t][e])return{x:e,y:t}}},{key:"move",value:function(e,t){var n=this.getNullCell(),r=(e-1==n.x||e+1==n.x)&&t==n.y,o=(t-1==n.y||t+1==n.y)&&e==n.x;(r||o)&&(this.field[n.y][n.x]=this.field[t][e],this.field[t][e]=0,this.clicks++)}},{key:"victory",value:function(e){var t=[];3==e?t=[[1,2,3],[4,5,6],[7,8,0]]:4==e?t=[[1,2,3,4],[5,6,7,8],[9,10,11,12],[13,14,15,0]]:5==e?t=[[1,2,3,4,5],[6,7,8,9,10],[11,12,13,14,15],[16,17,18,19,20],[21,22,23,24,0]]:6==e?t=[[1,2,3,4,5,6],[7,8,9,10,11,12],[13,14,15,16,17,18],[19,20,21,22,23,24],[25,26,27,28,29,30],[31,32,33,34,35,0]]:7==e?t=[[1,2,3,4,5,6,7],[8,9,10,11,12,13,14],[15,16,17,18,19,20,21],[22,23,24,25,26,27,28],[29,30,31,32,33,34,35],[36,37,38,39,40,41,42],[43,44,45,46,47,48,0]]:8==e&&(t=[[1,2,3,4,5,6,7,8],[9,10,11,12,13,14,15,16],[17,18,19,20,21,22,23,24],[25,26,27,28,29,30,31,32],[33,34,35,36,37,38,39,40],[41,42,43,44,45,46,47,48],[49,50,51,52,53,54,55,56],[57,58,59,60,61,62,63,0]]);for(var n=!0,r=0;r<e;r++)for(var o=0;o<e;o++)if(t[r][o]!=this.field[r][o]){n=!1;break}return n}}])&&s(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.overlay="",this.modalContent="",this.modalCloseBtn=""}var t,n;return t=e,n=[{key:"generateContent",value:function(){var e="",t=document.createElement("div");return t.className="modal__text",e+='<div class="modal__context">',e+="<p>".concat(this.text,"</p>"),e+="</div>",t.innerHTML=e,t}},{key:"renderModal",value:function(){this.buildModal()}},{key:"buildModal",value:function(){this.overlay=this.createDomNode(this.overlay,"div","overlay","overlay_modal"),this.modal=this.createDomNode(this.modal,"div","modal"),this.modalContent=this.generateContent(),this.modalCloseBtn=this.createDomNode(this.modalCloseBtn,"button","modal__close-btn"),this.modalCloseBtn.innerHTML='<svg width="14" height="14" viewBox="0 0 21 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.4239 10.5172L20.6009 2.33999C21.1331 1.80809 21.1331 0.948089 20.6009 0.416194C20.069 -0.115701 19.209 -0.115701 18.6771 0.416194L10.4999 8.59343L2.3229 0.416194C1.79076 -0.115701 0.931004 -0.115701 0.399108 0.416194C-0.133036 0.948089 -0.133036 1.80809 0.399108 2.33999L8.5761 10.5172L0.399108 18.6945C-0.133036 19.2263 -0.133036 20.0863 0.399108 20.6182C0.664184 20.8836 1.01272 21.0169 1.361 21.0169C1.70929 21.0169 2.05758 20.8836 2.3229 20.6182L10.4999 12.441L18.6771 20.6182C18.9425 20.8836 19.2907 21.0169 19.639 21.0169C19.9873 21.0169 20.3356 20.8836 20.6009 20.6182C21.1331 20.0863 21.1331 19.2263 20.6009 18.6945L12.4239 10.5172Z" fill="#EBC386"/></svg>',this.appendModalElements(),this.bindEvents(),this.openModal()}},{key:"createDomNode",value:function(e,t){var n;e=document.createElement(t);for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];return(n=e.classList).add.apply(n,o),e}},{key:"appendModalElements",value:function(){this.modal.append(this.modalCloseBtn),this.modal.append(this.modalContent),this.overlay.append(this.modal)}},{key:"bindEvents",value:function(){this.modalCloseBtn.addEventListener("click",this.closeModalByButton),this.overlay.addEventListener("click",this.closeModal)}},{key:"openModal",value:function(){document.body.append(this.overlay),document.body.classList.add("no-scroll")}},{key:"closeModal",value:function(e){e.target.classList.contains("overlay")&&document.querySelector(".overlay").remove(),document.body.classList.remove("no-scroll")}},{key:"closeModalByButton",value:function(){document.querySelector(".overlay").remove(),document.body.classList.remove("no-scroll")}}],n&&d(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();const v=function(e,t,n,r,o,i,a){console.log(n),console.log(a);var l=document.createElement("canvas");l.width=e,l.height=t;var s=l.getContext("2d");s.fillRect(0,0,l.width,l.height);var d=l.width/n,v=new c(s,n,e,t,a);window.matrix=v.field,v.ee(),v.draw(),function(e,t,n){for(var r=e,o=t,i=0,a=function(e){var t=e+"";return t.length<2?"0"+t:t},l=0;l<100;l++)window.clearInterval(l);o.innerHTML="00",r.innerHTML="00",setInterval((function(){++i,o.innerHTML=a(i%60),r.innerHTML=a(parseInt(i/60)),window.seconds=a(i%60),window.minutes=a(parseInt(i/60))}),1e3),window.minutes=r,window.seconds=o}(r,o),i.innerHTML="Moves: 0";return l.addEventListener("click",(function(n){(function(n,r){v.move(n,r),s.fillRect(0,0,e,t),v.ee(),v.draw(),window.matrix=v.field,function(){if(window.sound){var e=new Audio;e.src="../../assets/whoosh.mp3",e.autoplay=!0}}()})((n.pageX-l.offsetLeft)/d|0,(n.pageY-l.offsetTop)/d|0),i.innerHTML="Moves: ".concat(v.clicks),function(){if(v.victory(v.number)){new u("Hooray! You solved the puzzle in ".concat(window.minutes,":").concat(window.seconds," and ").concat(v.getClicks()," moves!")).renderModal();for(var e=0;e<100;e++)window.clearInterval(e);!function(e,t,n){var r=[];localStorage.getItem("results")&&(r=JSON.parse(localStorage.getItem("results"))),10==r.length&&r.shift();var o=[r.length,e,t,n];r.push(o),localStorage.setItem("results",JSON.stringify(r))}(window.minutes,window.seconds,v.getClicks())}}()})),[l,v]};function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t=e.title,n=e.number,r=e.className,o=document.createElement("button");return o.innerHTML=t,o.className=r,o.setAttribute("data-number",n),o.setAttribute("wrapNodeList",""),o};const h=function(e,t,n,r){var o=document.createElement("div");o.classList.add("sizeFieldButtons");var i=m({title:"3x3",className:"sizeFieldButton",number:3}),a=m({title:"4x4",className:"sizeFieldButton sizeFieldButton_active",number:4}),l=m({title:"5x5",className:"sizeFieldButton",number:5}),s=m({title:"6x6",className:"sizeFieldButton",number:6}),c=m({title:"7x7",className:"sizeFieldButton",number:7}),d=m({title:"8x8",className:"sizeFieldButton",number:8});o.append(i),o.append(a),o.append(l),o.append(s),o.append(c),o.append(d);var u=o.querySelectorAll("[wrapNodeList]");i.removeAttribute("wrapNodeList"),a.removeAttribute("wrapNodeList"),l.removeAttribute("wrapNodeList"),s.removeAttribute("wrapNodeList"),c.removeAttribute("wrapNodeList"),d.removeAttribute("wrapNodeList");var h,y=function(){u.forEach((function(e){e.classList.remove("sizeFieldButton_active")}))},w=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}(u);try{var p=function(){var o=h.value;o.addEventListener("click",(function(){y(),y(),o.classList.add("sizeFieldButton_active");var i=o.dataset.number,a=v(window.width,window.width,i,t,n,r,window.size);e.innerHTML="",e.append(a[0])}))};for(w.s();!(h=w.n()).done;)p()}catch(e){w.e(e)}finally{w.f()}return o};function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.array=t,this.overlay="",this.modalContent="",this.modalCloseBtn=""}var t,n;return t=e,n=[{key:"generateContent",value:function(){var e="",t=document.createElement("div");if(t.className="modal__winners",e+='<div class="modal__list">',Array.isArray(this.array)){e+="<ol>";for(var n=0;n<this.array.length;n++)e+="<li>Time: ".concat(this.array[n][1],":").concat(this.array[n][2],"   Clicks: ").concat(this.array[n][3],"</li>");e+="</ol>"}else e+='<p class="message">'.concat(this.array,"</p>");return e+="</div>",t.innerHTML=e,t}},{key:"renderModal",value:function(){this.buildModal()}},{key:"buildModal",value:function(){this.overlay=this.createDomNode(this.overlay,"div","overlay","overlay_modal"),this.modal=this.createDomNode(this.modal,"div","modal-win"),this.modalContent=this.generateContent(),this.modalCloseBtn=this.createDomNode(this.modalCloseBtn,"button","modal__close-button"),this.modalCloseBtn.innerHTML='<svg width="14" height="14" viewBox="0 0 21 22" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.4239 10.5172L20.6009 2.33999C21.1331 1.80809 21.1331 0.948089 20.6009 0.416194C20.069 -0.115701 19.209 -0.115701 18.6771 0.416194L10.4999 8.59343L2.3229 0.416194C1.79076 -0.115701 0.931004 -0.115701 0.399108 0.416194C-0.133036 0.948089 -0.133036 1.80809 0.399108 2.33999L8.5761 10.5172L0.399108 18.6945C-0.133036 19.2263 -0.133036 20.0863 0.399108 20.6182C0.664184 20.8836 1.01272 21.0169 1.361 21.0169C1.70929 21.0169 2.05758 20.8836 2.3229 20.6182L10.4999 12.441L18.6771 20.6182C18.9425 20.8836 19.2907 21.0169 19.639 21.0169C19.9873 21.0169 20.3356 20.8836 20.6009 20.6182C21.1331 20.0863 21.1331 19.2263 20.6009 18.6945L12.4239 10.5172Z" fill="#EBC386"/></svg>',this.appendModalElements(),this.bindEvents(),this.openModal()}},{key:"createDomNode",value:function(e,t){var n;e=document.createElement(t);for(var r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];return(n=e.classList).add.apply(n,o),e}},{key:"appendModalElements",value:function(){this.modal.append(this.modalCloseBtn),this.modal.append(this.modalContent),this.overlay.append(this.modal)}},{key:"bindEvents",value:function(){this.modalCloseBtn.addEventListener("click",this.closeModalByButton),this.overlay.addEventListener("click",this.closeModal)}},{key:"openModal",value:function(){document.body.append(this.overlay),document.body.classList.add("no-scroll")}},{key:"closeModal",value:function(e){e.target.classList.contains("overlay")&&document.querySelector(".overlay").remove(),document.body.classList.remove("no-scroll")}},{key:"closeModalByButton",value:function(){document.querySelector(".overlay").remove(),document.body.classList.remove("no-scroll")}}],n&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function p(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=g(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){l=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(l)throw i}}}}function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,l=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){l=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(l)throw o}}return i}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}window.addEventListener("DOMContentLoaded",(function(){localStorage.clear(),localStorage.removeItem("field"),localStorage.removeItem("number");var a=window.matchMedia("(min-width: 1280px)"),l=window.matchMedia("(min-width: 768px)"),s=0,c=0;a.matches?(s=546,c=58):l.matches?(s=426,c=50):(s=306,c=36),window.width=s,window.size=c;var d=document.querySelector(".root"),u=document.createElement("div");u.classList.add("container");var f=function(){var a=document.createElement("div");a.className="buttons";var l=e({listener:t,title:"Restart",className:"restart"}),s=e({listener:n,title:"Save",className:"save"}),c=e({listener:r,title:"Load",className:"load"}),d=e({listener:o,title:"Sound",className:"sound"}),u=e({listener:i,title:"Results",className:"results"});return a.append(l),a.append(s),a.append(c),a.append(d),a.append(u),a}(),m=document.createElement("div");m.classList.add("statistics");var y=b(function(){var e=document.createElement("div");e.classList.add("statistics__moves"),e.innerHTML="Moves: 0";var t=document.createElement("div");return t.classList.add("statistics__timer"),t.innerHTML='<span id="minutes">00</span>\n                      <span id="colon">:</span>\n                      <span id="seconds">00</span>',[e,t]}(),2),g=y[0],L=y[1],S=document.createElement("div");S.classList.add("canvasContainer");var C=L.querySelector("#minutes"),k=L.querySelector("#seconds");m.append(g,L);var M=b(v(window.width,window.width,4,C,k,g,window.size),2),E=M[0],x=M[1];window.matrix=x.field,window.active=x.field;var N=h(S,C,k,g);S.append(E),u.append(f),u.append(m),u.append(S),u.append(N),d.append(u),window.sound=!0,window.addEventListener("resize",(function(){var e=0,t=0;a.matches?(e=546,t=58):l.matches?(e=426,t=50):(e=306,t=36),window.width=e,window.size=t;var n=window.active,r=b(v(window.width,window.width,window.matrix.length,C,k,g,window.size),2),o=r[0],i=r[1];i.field=n,i.ee(),i.draw();var s=document.querySelector(".canvasContainer"),c=s.querySelector("canvas");s.replaceChild(o,c)}));var B,A,z=document.querySelector(".restart");B=4,z.addEventListener("click",(function(){B=document.querySelector(".sizeFieldButton_active").dataset.number;var e=b(v(window.width,window.width,B,C,k,g,window.size),2),t=e[0];e[1],S.innerHTML="",S.append(t)})),document.querySelector(".save").addEventListener("click",(function(){localStorage.setItem("field",JSON.stringify(window.matrix)),localStorage.setItem("number",JSON.stringify(window.num))})),document.querySelector(".load").addEventListener("click",(function(){var e=JSON.parse(localStorage.getItem("field")),t=b(v(window.width,window.width,e.length,C,k,g,window.size),2),n=t[0];t[1].field=e;var r=document.querySelector(".canvasContainer"),o=r.querySelector("canvas");r.replaceChild(n,o);var i,a=document.querySelectorAll(".sizeFieldButton"),l=p(a);try{for(l.s();!(i=l.n()).done;)i.value.classList.remove("sizeFieldButton_active")}catch(e){l.e(e)}finally{l.f()}var s,c=p(a);try{for(c.s();!(s=c.n()).done;){var d=s.value;d.dataset.number==e.length&&d.classList.add("sizeFieldButton_active")}}catch(e){c.e(e)}finally{c.f()}localStorage.removeItem("field"),localStorage.removeItem("number")})),(A=document.querySelector(".sound")).addEventListener("click",(function(){A.classList.toggle("sound_active"),window.sound=!window.sound})),document.querySelector(".results").addEventListener("click",(function(){if(localStorage.getItem("results")){var e=JSON.parse(localStorage.getItem("results"));console.log(e),new w(e).renderModal()}else new w("No results").renderModal()}))}))})();